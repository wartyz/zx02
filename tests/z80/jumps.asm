; =====================================================
; jumps.asm - pruebas de saltos y control de flujo Z80
; =====================================================

        DEVICE ZXSPECTRUM48
        ORG 0000h

START:
; -----------------------------------------------------
; Inicialización
; -----------------------------------------------------
        LD SP,5C00h
        LD A,00h
        LD B,05h

; -----------------------------------------------------
; JR sin condición
; -----------------------------------------------------
        JR JR_TARGET

JR_SKIP:
        NOP
        NOP

JR_TARGET:
        INC A

; -----------------------------------------------------
; JR condicional
; -----------------------------------------------------
        CP 01h
        JR Z, JR_Z_OK
        JR NZ, JR_NZ_OK

JR_Z_OK:
        INC A

JR_NZ_OK:
        INC A

; -----------------------------------------------------
; DJNZ (bucle corto)
; -----------------------------------------------------
DJNZ_LOOP:
        DJNZ DJNZ_LOOP

; -----------------------------------------------------
; JP absoluto
; -----------------------------------------------------
        JP JP_TARGET

JP_SKIP:
        NOP
        NOP

JP_TARGET:
        INC A

; -----------------------------------------------------
; CALL / RET
; -----------------------------------------------------
        CALL SUB1
        INC A
        CALL SUB2
        INC A

; -----------------------------------------------------
; CALL condicional
; -----------------------------------------------------
        CP 05h
        CALL Z, SUB3
        CALL NZ, SUB4

; -----------------------------------------------------
; JP condicional
; -----------------------------------------------------
        JP Z, JP_Z
        JP NZ, JP_NZ

JP_Z:
        INC A

JP_NZ:
        INC A

; -----------------------------------------------------
; RET condicional
; -----------------------------------------------------
        CALL SUB_RET_TEST
        INC A

; -----------------------------------------------------
; RST
; -----------------------------------------------------
        RST 00h
        RST 08h
        RST 10h
        RST 18h
        RST 20h
        RST 28h
        RST 30h
        RST 38h

; -----------------------------------------------------
; Fin
; -----------------------------------------------------
        HALT

; =====================================================
; Subrutinas
; =====================================================

SUB1:
        INC A
        RET

SUB2:
        INC A
        RET

SUB3:
        INC A
        RET

SUB4:
        INC A
        RET

SUB_RET_TEST:
        CP 20h
        RET Z
        RET NZ

; -----------------------------------------------------
; Salida binaria
; -----------------------------------------------------
        SAVEBIN "jumps.bin", 0, $
